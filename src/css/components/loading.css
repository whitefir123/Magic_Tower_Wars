/* ========================================================================
   LOADING SCREEN COMPONENTS
   ======================================================================== */

#loading-overlay, .loading-overlay-screen { 
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: #000;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  z-index: 999999;
  transition: opacity 0.8s ease-in-out;
  opacity: 1;
  pointer-events: auto;
  overflow: hidden; /* è£å‰ªèƒŒæ™¯å±‚æº¢å‡ºï¼Œé˜²æ­¢æ»šåŠ¨æ¡ */
}

/* æ˜¾ç¤ºçŠ¶æ€ - ç”µå½±çº§è¿‡æ¸¡ */
.loading-overlay-screen.overlay-active {
  opacity: 1;
  transition: opacity 0.8s ease-in-out;
  pointer-events: auto;
}

/* æ·¡å‡ºçŠ¶æ€ - ç”µå½±çº§è¿‡æ¸¡ */
.loading-overlay-screen.overlay-exit,
#loading-overlay.overlay-exit { /* ğŸ”´ æ–°å¢ï¼šç¡®ä¿ ID é€‰æ‹©å™¨ä¹Ÿèƒ½è§¦å‘ç‚¹å‡»ç©¿é€ */
  opacity: 0;
  pointer-events: none !important; /* ğŸ”´ å…³é”®ï¼šç«‹å³é‡Šæ”¾ç‚¹å‡»ç©¿é€ï¼Œé˜²æ­¢è¿‡æ¸¡æœŸé—´æ— æ³•æ“ä½œ */
}

.loading-overlay-screen.hidden,
#loading-overlay.hidden { /* ğŸ”´ æ–°å¢ï¼šç¡®ä¿ ID é€‰æ‹©å™¨ä¹Ÿèƒ½å®Œå…¨éšè— */
  opacity: 0;
  pointer-events: none !important;
  display: none !important; /* å¼ºåˆ¶ display none */
  visibility: hidden !important; /* é¢å¤–ä¿é™© */
  z-index: -1 !important; /* æ²‰åˆ°åº•éƒ¨ */
}

.loading-overlay-screen {
  display: flex;
}

.loader { 
  border:3px solid #333; 
  border-top:3px solid var(--accent-gold); 
  border-radius:50%; 
  width:60px; 
  height:60px; 
  animation: spin 1s linear infinite; 
  margin-top: 2px;
  margin-bottom: 2px;
}

@keyframes spin { 
  0%{ transform: rotate(0);} 
  100%{ transform: rotate(360deg);} 
}

/* ========================================================================
   Loading Progress Bar (Refined Assets)
   ======================================================================== */

.loading-bar-container {
  width: 520px;  /* æ”¾å¤§å°ºå¯¸ */
  max-width: 90vw; /* å“åº”å¼ï¼šç¡®ä¿åœ¨æçª„å±å¹•ä¸‹ä¸ä¼šæº¢å‡º */
  height: 71px;  /* è°ƒæ•´é«˜åº¦ä»¥åŒ¹é…æ¯”ä¾‹ */
  padding: 10px 14px; /* æ§åˆ¶å†…èƒ†ä½ç½®ï¼Œé˜²æ­¢æº¢å‡ºè¾¹æ¡† */
  
  /* ç§»é™¤åŸèƒŒæ™¯ï¼Œæ”¹ä¸ºé€æ˜ */
  background: transparent;
  border: none;
  box-shadow: none;
  
  position: relative;
  z-index: 10; /* æ˜¾å¼è®¾ç½®å±‚çº§ï¼Œç¡®ä¿åœ¨èƒŒæ™¯å±‚å’Œé®ç½©å±‚ä¹‹ä¸Š */
  overflow: visible; /* å…è®¸è¾¹æ¡†é˜´å½±æº¢å‡º */
  display: flex;
  align-items: center;
  justify-content: flex-start;
  margin-top: 0px;
}

/* ä½¿ç”¨ä¼ªå…ƒç´ æ”¾ç½®è¾¹æ¡†ï¼Œå±‚çº§ä¸º 2 */
.loading-bar-container::after {
  content: '';
  position: absolute;
  inset: 0;
  background: url('https://i.postimg.cc/kGydx3N7/loadingkuang1.png') no-repeat center center;
  background-size: 100% 100%;
  z-index: 2; /* åœ¨è¿›åº¦æ¡ä¹‹ä¸Š */
  pointer-events: none;
}

/* æ·»åŠ ä¸€ä¸ªæµå…‰åŠ¨ç”»æ•ˆæœï¼Œè®©çº¹ç†çœ‹èµ·æ¥åœ¨æµåŠ¨ */
@keyframes bar-flow {
  0% { background-position: 0 0; }
  100% { background-position: 100px 0; }
}

#loading-bar-fill, .loading-bar-fill {
  height: 33px;
  width: 0%;
  position: relative;
  z-index: 1; /* åœ¨è¾¹æ¡†ä¹‹ä¸‹ */
  
  border-radius: 12px; /* åœ†è§’é€‚åº” */
  
  /* ä¿æŒåŸæœ‰çš„çº¹ç†å’ŒåŠ¨ç”»é€»è¾‘ */
  background: url('https://i.postimg.cc/v8hPNvPw/loadingquality3.png') repeat-x left center;
  background-size: auto 100%;
  transition: width 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  box-shadow: 0 0 15px rgba(255, 180, 0, 0.5); /* å¢å¼ºå‘å…‰ */
  filter: brightness(1.2) contrast(1.1);
  
  animation: bar-flow 2s linear infinite;
}

#loading-percent, .loading-percent {
  margin-top: 15px;
  font-family: var(--font-header);
  font-size: 1.2rem;
  color: var(--accent-gold);
  letter-spacing: 1px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
}

/* Hide main UI until loading is complete */
#main-ui {
  display: none !important;
}
/* åªè¦æœ‰ loaded æˆ– scene-active ç±»ï¼Œéƒ½å¼ºåˆ¶æ˜¾ç¤º */
#main-ui.loaded,
#main-ui.scene-active {
  display: flex !important;
}

#char-select-screen {
  display: none !important;
}

#char-select-screen.loaded,
#char-select-screen.scene-transition {
  display: block !important;
}

/* Loading Tips Container - Bottom Left */
.loading-tips-container {
  position: absolute;
  bottom: 80px;
  left: 40px;
  display: flex;
  align-items: center;
  gap: 12px;
  font-family: var(--font-header);
  font-size: 1.1rem;
  width: auto;
  min-width: 411px;
  max-width: 90vw;
  height: 59px;
  animation: fadeInTip 0.5s ease-in-out;
}

.tip-label {
  color: var(--accent-gold);
  font-weight: bold;
  letter-spacing: 1px;
  text-shadow: 0 2px 4px rgba(0,0,0,0.8);
}

#loading-tip-text, .loading-tip-text {
  color: #aaa;
  font-family: var(--font-body);
  font-size: 0.95rem;
  line-height: 1.4;
  height: 15px;
  text-shadow: 0 1px 2px rgba(0,0,0,0.8);
  opacity: 1;
  transition: opacity 0.25s ease-in-out;
  white-space: nowrap;
  flex-shrink: 0;
}

@keyframes fadeInTip {
  0% { opacity: 0; transform: translateX(-10px); }
  100% { opacity: 1; transform: translateX(0); }
}

/* Loading Chase Container - Bottom Right */
.loading-chase-container {
  position: absolute;
  bottom: 0;
  right: 20px;
  width: auto;
  height: 64px;
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 0px;
}

#loading-butterfly, .loading-butterfly {
  width: 128px;
  height: 64px;
  aspect-ratio: 2 / 1;
  background-image: url('https://i.postimg.cc/kXKPYW3B/hudie1.png');
  background-size: 400% 100%;
  background-repeat: no-repeat;
  background-position: 0% 0%;
  image-rendering: pixelated;
  /* å¸§åˆ‡æ¢æ”¹ç”± JS æ§åˆ¶ï¼Œä»…ä¿ç•™ä½ç§»åŠ¨ç”» */
  animation: butterfly-move 3s ease-in-out infinite;
  position: relative;
  z-index: 2;
  margin-left: -32px;
  border: none !important;
  outline: none !important;
  box-shadow: none !important;
}

#loading-butterfly canvas, .loading-butterfly canvas {
  border: none !important;
  outline: none !important;
  box-shadow: none !important;
  display: block;
  width: 100%;
  height: 100%;
}

#loading-skeleton, .loading-skeleton {
  width: 128px;
  height: 64px;
  aspect-ratio: 2 / 1;
  background-image: url('https://i.postimg.cc/v8K6Xkwy/gulaidekulou1.png');
  background-size: 400% 100%;
  background-repeat: no-repeat;
  background-position: 0% 0%;
  image-rendering: pixelated;
  /* å¸§åˆ‡æ¢æ”¹ç”± JS æ§åˆ¶ï¼Œä¸è¿›è¡Œä½ç§»åŠ¨ç”» */
  position: relative;
  z-index: 1;
  border: none !important;
  outline: none !important;
  box-shadow: none !important;
}

#loading-skeleton canvas, .loading-skeleton canvas {
  border: none !important;
  outline: none !important;
  box-shadow: none !important;
  display: block;
  width: 100%;
  height: 100%;
}

/* è´è¶å’Œéª·é«…çš„åŠ¨ç”» - ä»…æ§åˆ¶ä½ç§»ï¼Œå¸§åˆ‡æ¢ç”± JS æ§åˆ¶ */
@keyframes butterfly-move {
  0%, 100% {
    transform: translateX(-40px) translateY(-25px);
  }
  50% {
    transform: translateX(0px) translateY(-30px);
  }
}

@keyframes skeleton-chase {
  0%, 100% {
    transform: translateX(0);
  }
  50% {
    transform: translateX(60px);
  }
}

/* ========================================================================
   Dynamic Background System
   ======================================================================== */

/* èƒŒæ™¯å±‚å®¹å™¨ - ç»å¯¹å®šä½åœ¨æœ€åº•å±‚ */
.loading-bg-layer {
  position: absolute;
  inset: -5%; /* ç¨å¾®å»¶ä¼¸å‡ºè¾¹ç•Œï¼Œé˜²æ­¢åŠ¨ç”»ç¼©æ”¾æ—¶éœ²åº• */
  width: 110%;
  height: 110%;
  z-index: 0; /* æœ€åº•å±‚ */
  
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  
  /* Ken Burns å‘¼å¸æ•ˆæœåŠ¨ç”» */
  animation: ken-burns 30s ease-in-out infinite alternate;
  
  /* åˆå§‹é€æ˜åº¦ä¸º0ï¼Œé€šè¿‡JSåŠ è½½å®Œæˆåè®¾ä¸º1ï¼Œå®ç°æ·¡å…¥æ•ˆæœ */
  opacity: 0; 
  transition: opacity 1s ease-in-out;
}

/* ç¡®ä¿æ‰€æœ‰å‰æ™¯å†…å®¹éƒ½åœ¨èƒŒæ™¯ä¹‹ä¸Š */
.loader, 
.loading-bar-container, 
.loading-percent {
  position: relative;
  z-index: 10; /* æå‡å±‚çº§ */
}

/* æç¤ºå’ŒåŠ¨ç”»å®¹å™¨ä¿æŒç»å¯¹å®šä½ï¼Œä½†ç¡®ä¿å±‚çº§åœ¨èƒŒæ™¯ä¹‹ä¸Š */
.loading-tips-container, 
.loading-chase-container {
  z-index: 10; /* æå‡å±‚çº§ï¼Œä½†ä¿æŒåŸæœ‰çš„ç»å¯¹å®šä½ */
}

/* Ken Burns åŠ¨ç”»å…³é”®å¸§ */
@keyframes ken-burns {
  0% {
    transform: scale(1.0) translate(0, 0);
  }
  50% {
    transform: scale(1.1) translate(-1%, -1%);
  }
  100% {
    transform: scale(1.0) translate(1%, 1%);
  }
}

/* ========================================================================
   Atmospheric Vignette Overlay (Static Lens Effect)
   ======================================================================== */
#loading-overlay::after,
.loading-overlay-screen::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
  z-index: 5 !important; /* ä½äºèƒŒæ™¯(0)ä¹‹ä¸Šï¼Œä½†ä½äºå†…å®¹(10)ä¹‹ä¸‹ */
  pointer-events: none;
  
  /* å¤åˆå¾„å‘æ¸å˜ï¼šå®ç°ä¸­å¿ƒé€äº®ã€å››å‘¨å‹æš—çš„æ•ˆæœ */
  background: radial-gradient(
    circle at center,
    rgba(0, 0, 0, 0.2) 0%,    /* ä¸­å¿ƒï¼šè½»å¾®é®ç½©ï¼Œä¿ç•™èƒŒæ™¯ç»†èŠ‚ */
    rgba(0, 0, 0, 0.5) 50%,   /* ä¸­é—´ï¼šåŠ æ·±ï¼Œç¡®ä¿æ–‡å­—å¯è¯» */
    rgba(0, 0, 0, 0.95) 100%  /* è¾¹ç¼˜ï¼šæ·±æ²‰æš—è§’ï¼Œè¥é€ æ°›å›´ */
  ) !important;
  
  /* æ·»åŠ è½»å¾®çš„å™ªç‚¹çº¹ç†å¢åŠ å¤å¤/æš—é»‘è´¨æ„Ÿ (å¯é€‰ï¼Œä½¿ç”¨æ··åˆæ¨¡å¼) */
  box-shadow: inset 0 0 100px rgba(0,0,0,0.8) !important;
}