# èµŒå¾’å¥–å“Tooltipä¿®å¤è¯´æ˜

## é—®é¢˜æè¿°
èµŒå¾’ç•Œé¢ä¸­çš„æŸäº›å¥–å“ï¼ˆå¦‚å¹¸è¿çŸ³ã€ç¬¦æ–‡ç­‰ï¼‰çš„æç¤ºæ¡†ï¼ˆtooltipï¼‰ä¸¢å¤±ï¼Œé¼ æ ‡æ‚¬åœæ—¶æ— æ³•æ˜¾ç¤ºç‰©å“è¯¦æƒ…ã€‚

## é—®é¢˜åŸå› 
1. **TooltipManageræœªå¤„ç†ç‰¹æ®Šç‰©å“ç±»å‹**ï¼šåŸæœ‰çš„`generateTooltipContent`æ–¹æ³•åªå¤„ç†æ ‡å‡†è£…å¤‡å’Œæ¶ˆè€—å“ï¼Œæ²¡æœ‰é’ˆå¯¹å¹¸è¿çŸ³ï¼ˆtrashç±»å‹ï¼‰å’Œç¬¦æ–‡ï¼ˆruneç±»å‹ï¼‰çš„ç‰¹æ®Šå¤„ç†é€»è¾‘ã€‚

2. **ç‰©å“å¯¹è±¡ä¼ é€’ä¸å®Œæ•´**ï¼šåœ¨`ReelAnimator.js`å’Œ`HistoryTracker.js`ä¸­ï¼Œtooltipåªåœ¨`item.data`å­˜åœ¨æ—¶æ‰æ˜¾ç¤ºï¼Œä½†å¹¸è¿çŸ³å’Œç¬¦æ–‡çš„å®Œæ•´ä¿¡æ¯åœ¨ç‰©å“å¯¹è±¡æœ¬èº«ï¼Œè€Œä¸ä»…ä»…åœ¨`data`å­—æ®µä¸­ã€‚

## ä¿®å¤æ–¹æ¡ˆ

### 1. æ‰©å±•TooltipManageræ”¯æŒç‰¹æ®Šç‰©å“ç±»å‹

**æ–‡ä»¶ï¼š`src/utils/TooltipManager.js`**

åœ¨`generateTooltipContent`æ–¹æ³•å¼€å¤´æ·»åŠ ç‰¹æ®Šç‰©å“ç±»å‹çš„å¤„ç†ï¼š

```javascript
// âœ… å¤„ç†ç‰¹æ®Šç‰©å“ç±»å‹ï¼ˆå¹¸è¿çŸ³ã€ç¬¦æ–‡ç­‰ï¼‰
if (itemOrId && typeof itemOrId === 'object') {
  // å¹¸è¿çŸ³
  if (itemOrId.type === 'trash' && itemOrId.name === 'å¹¸è¿çŸ³') {
    // ç”Ÿæˆå¹¸è¿çŸ³ä¸“ç”¨tooltip
    // æ˜¾ç¤ºï¼šåç§°ã€ç±»å‹ï¼ˆææ–™ï¼‰ã€æè¿°ã€å¼ºåŒ–æˆåŠŸç‡åŠ æˆ
  }
  
  // ç¬¦æ–‡
  if (itemOrId.type === 'rune' && itemOrId.data) {
    // ç”Ÿæˆç¬¦æ–‡ä¸“ç”¨tooltip
    // æ˜¾ç¤ºï¼šåç§°ã€ç±»å‹ï¼ˆç¬¦æ–‡ï¼‰ã€ç¬¦æ–‡ç±»å‹ï¼ˆå±æ€§æå‡/æˆ˜æ–—æœºåˆ¶/è¯…å’’ï¼‰ã€æè¿°
  }
}
```

#### å¹¸è¿çŸ³Tooltipæ˜¾ç¤ºå†…å®¹ï¼š
- **åç§°**ï¼šå¹¸è¿çŸ³ï¼ˆå¸¦å“è´¨é¢œè‰²ï¼‰
- **ç±»å‹**ï¼šææ–™
- **æè¿°**ï¼šå®Œæ•´çš„ç‰©å“æè¿°æ–‡æœ¬
- **å¼ºåŒ–æˆåŠŸç‡**ï¼š+5.0%ï¼ˆç»¿è‰²é«˜äº®ï¼‰

#### ç¬¦æ–‡Tooltipæ˜¾ç¤ºå†…å®¹ï¼š
- **åç§°**ï¼šç¬¦æ–‡åç§°ï¼ˆå¸¦å“è´¨é¢œè‰²ï¼‰
- **ç±»å‹**ï¼šç¬¦æ–‡
- **ç¬¦æ–‡ç±»å‹**ï¼šå±æ€§æå‡/æˆ˜æ–—æœºåˆ¶/è¯…å’’
- **æè¿°**ï¼šæ ¹æ®å“è´¨ç”Ÿæˆçš„å®Œæ•´æè¿°

### 2. ä¿®å¤ç‰©å“å¯¹è±¡ä¼ é€’é€»è¾‘

**æ–‡ä»¶ï¼š`src/ui/ReelAnimator.js`**

ä¿®æ”¹tooltipäº‹ä»¶ç»‘å®šï¼Œä¼˜å…ˆä½¿ç”¨å®Œæ•´çš„ç‰©å“å¯¹è±¡ï¼š

```javascript
// ä¿®æ”¹å‰
el.addEventListener('mouseenter', (e) => {
  if (item.data) {
    globalTooltipManager.show(item.data, e.clientX, e.clientY);
  }
});

// ä¿®æ”¹å
el.addEventListener('mouseenter', (e) => {
  const tooltipItem = item.data ? item : (item.type ? item : null);
  if (tooltipItem) {
    globalTooltipManager.show(tooltipItem, e.clientX, e.clientY);
  }
});
```

**æ–‡ä»¶ï¼š`src/ui/HistoryTracker.js`**

åŒæ ·ä¿®æ”¹å†å²è®°å½•ä¸­çš„tooltipç»‘å®šï¼š

```javascript
// ä¿®æ”¹å‰
if (entry.reward.data) {
  globalTooltipManager.show(entry.reward.data, e.clientX, e.clientY);
}

// ä¿®æ”¹å
const tooltipItem = entry.reward.data ? entry.reward : (entry.reward.type ? entry.reward : null);
if (tooltipItem) {
  globalTooltipManager.show(tooltipItem, e.clientX, e.clientY);
}
```

## ä¿®å¤æ•ˆæœ

### å¹¸è¿çŸ³Tooltipç¤ºä¾‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¹¸è¿çŸ³                          â”‚
â”‚ ææ–™                            â”‚
â”‚                                 â”‚
â”‚ æ™®é€šçš„å¹¸è¿çŸ³ï¼Œå¯ä½œä¸ºå¼ºåŒ–åº•æ–™    â”‚
â”‚ ä½¿ç”¨ï¼Œæå‡0.05çš„å¼ºåŒ–æˆåŠŸç‡ã€‚    â”‚
â”‚ è™½ç„¶æ•ˆæœå¾®å¼±ï¼Œä½†æ€»æ¯”ä¸€æ— æ‰€è·    â”‚
â”‚ è¦å¥½ã€‚                          â”‚
â”‚                                 â”‚
â”‚ å¼ºåŒ–æˆåŠŸç‡: +5.0%               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç¬¦æ–‡Tooltipç¤ºä¾‹ï¼ˆç¨€æœ‰å“è´¨ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç‹‚æš´è›®åŠ›                        â”‚
â”‚ ç¬¦æ–‡                            â”‚
â”‚ å±æ€§æå‡                        â”‚
â”‚                                 â”‚
â”‚ ç¨€æœ‰ç¬¦æ–‡ï¼Œå…·æœ‰ä¸é”™çš„æ•ˆæœã€‚      â”‚
â”‚ ç‰©ç†æ”»å‡»åŠ› +3                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æµ‹è¯•éªŒè¯

è¿è¡Œæµ‹è¯•é¡µé¢ï¼š
```bash
# åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
test_gambler_tooltip.html
```

æµ‹è¯•å†…å®¹ï¼š
1. âœ… å¹¸è¿çŸ³æ˜¾ç¤ºå®Œæ•´tooltipï¼ˆåŒ…æ‹¬æè¿°å’Œå¼ºåŒ–æˆåŠŸç‡ï¼‰
2. âœ… ä¸åŒå“è´¨çš„ç¬¦æ–‡æ˜¾ç¤ºå¯¹åº”çš„tooltip
3. âœ… å…¶ä»–ç‰©å“ï¼ˆè£…å¤‡ã€æ¶ˆè€—å“ã€Buffç­‰ï¼‰æ­£å¸¸æ˜¾ç¤ºtooltip
4. âœ… å†å²è®°å½•ä¸­çš„ç‰©å“ä¹Ÿèƒ½æ­£å¸¸æ˜¾ç¤ºtooltip

## æŠ€æœ¯ç»†èŠ‚

### ç‰©å“å¯¹è±¡ç»“æ„

**å¹¸è¿çŸ³ï¼š**
```javascript
{
  type: 'trash',
  name: 'å¹¸è¿çŸ³',
  quality: 'COMMON',
  icon: 'ğŸª¨',
  desc: 'æ™®é€šçš„å¹¸è¿çŸ³ï¼Œå¯ä½œä¸ºå¼ºåŒ–åº•æ–™ä½¿ç”¨...',
  successRateBonus: 0.05
}
```

**ç¬¦æ–‡ï¼š**
```javascript
{
  type: 'rune',
  runeId: 'might',
  name: 'è›®åŠ›',
  quality: 'UNCOMMON',
  icon: 'ğŸ“œ',
  desc: 'æ™®é€šç¬¦æ–‡ï¼Œæä¾›åŸºç¡€å±æ€§åŠ æˆã€‚ç‰©ç†æ”»å‡»åŠ› +1',
  data: { /* RUNE_POOLä¸­çš„ç¬¦æ–‡å®šä¹‰ */ }
}
```

### Tooltipç”Ÿæˆä¼˜å…ˆçº§

1. æ£€æŸ¥æ˜¯å¦ä¸ºæŠ€èƒ½å¯¹è±¡ï¼ˆ`type === 'SKILL'`ï¼‰
2. æ£€æŸ¥æ˜¯å¦ä¸ºå¹¸è¿çŸ³ï¼ˆ`type === 'trash' && name === 'å¹¸è¿çŸ³'`ï¼‰
3. æ£€æŸ¥æ˜¯å¦ä¸ºç¬¦æ–‡ï¼ˆ`type === 'rune' && data`ï¼‰
4. æ ‡å‡†ç‰©å“å¤„ç†ï¼ˆè£…å¤‡ã€æ¶ˆè€—å“ç­‰ï¼‰

## å…¼å®¹æ€§

- âœ… å‘åå…¼å®¹ï¼šä¸å½±å“ç°æœ‰ç‰©å“çš„tooltipæ˜¾ç¤º
- âœ… æ‰©å±•æ€§ï¼šå¯ä»¥è½»æ¾æ·»åŠ æ›´å¤šç‰¹æ®Šç‰©å“ç±»å‹çš„tooltipæ”¯æŒ
- âœ… æ€§èƒ½ï¼šä¸å¢åŠ é¢å¤–çš„æ€§èƒ½å¼€é”€

## ç›¸å…³æ–‡ä»¶

ä¿®æ”¹çš„æ–‡ä»¶ï¼š
- `src/utils/TooltipManager.js` - æ·»åŠ ç‰¹æ®Šç‰©å“ç±»å‹å¤„ç†
- `src/ui/ReelAnimator.js` - ä¿®å¤ç‰©å“å¯¹è±¡ä¼ é€’
- `src/ui/HistoryTracker.js` - ä¿®å¤å†å²è®°å½•tooltip

æµ‹è¯•æ–‡ä»¶ï¼š
- `test_gambler_tooltip.html` - TooltipåŠŸèƒ½æµ‹è¯•é¡µé¢

## æ³¨æ„äº‹é¡¹

1. ç¡®ä¿ç‰©å“å¯¹è±¡åŒ…å«å¿…è¦çš„å­—æ®µï¼ˆ`type`ã€`name`ã€`desc`ç­‰ï¼‰
2. ç¬¦æ–‡å¿…é¡»åŒ…å«`data`å­—æ®µï¼ˆæŒ‡å‘RUNE_POOLä¸­çš„ç¬¦æ–‡å®šä¹‰ï¼‰
3. å¹¸è¿çŸ³çš„`successRateBonus`å­—æ®µç”¨äºæ˜¾ç¤ºå¼ºåŒ–æˆåŠŸç‡åŠ æˆ
4. Tooltipæ ·å¼ç”±CSSæ§åˆ¶ï¼Œç¡®ä¿`#tooltip`å…ƒç´ å­˜åœ¨
