# 铁匠铺UI测试指南

## 快速测试步骤

### 1. 启动游戏
```bash
# 如果有开发服务器
npm run dev

# 或者直接打开
# 在浏览器中打开 game.html 或 index.html
```

### 2. 打开铁匠铺
在游戏中找到铁匠铺入口并点击，或者在控制台执行：
```javascript
// 如果有全局game对象
game.forgeUI.open();
```

### 3. 检查初始界面

**应该看到：**
- ✅ 全屏背景图片（铁匠铺场景）
- ✅ 左侧有铁匠NPC精灵图
- ✅ NPC下方显示等级和好感度信息
- ✅ 右上角有6个功能按钮垂直排列：
  - ⚒️ 强化/重铸
  - 💎 宝石镶嵌
  - 🔮 宝石合成
  - 🔨 装备拆解
  - 📦 批量操作
  - 📜 操作历史
- ✅ 右上角有关闭按钮（✕）
- ✅ 界面中央空白，背景清晰可见

### 4. 测试功能按钮

#### 测试"强化/重铸"按钮
1. 点击"⚒️ 强化/重铸"按钮
2. **应该看到：**
   - 面板从右侧滑入（动画约300ms）
   - 面板显示在中央偏右位置
   - 面板标题显示"装备强化/重铸"
   - 面板有半透明背景
   - 面板右上角有关闭按钮（✕）
   - 左侧NPC和右侧功能按钮仍然可见
   - 面板内显示"选择装备"和"装备详情"两个区域

#### 测试"宝石镶嵌"按钮
1. 点击"💎 宝石镶嵌"按钮
2. **应该看到：**
   - 当前面板（如果有）先滑出
   - 新面板滑入
   - 面板标题显示"宝石镶嵌"
   - 面板内显示装备列表和宝石槽位区域

#### 测试其他按钮
重复上述步骤测试：
- 🔮 宝石合成
- 🔨 装备拆解
- 📦 批量操作
- 📜 操作历史

### 5. 测试面板关闭

#### 方法1：点击面板关闭按钮
1. 打开任意功能面板
2. 点击面板右上角的关闭按钮（✕）
3. **应该看到：**
   - 面板向右滑出消失（动画约240ms）
   - 返回初始简洁状态
   - 只显示背景、NPC和功能按钮

#### 方法2：切换功能
1. 打开"强化/重铸"面板
2. 点击"宝石镶嵌"按钮
3. **应该看到：**
   - 强化面板先滑出
   - 宝石镶嵌面板滑入
   - 切换流畅无卡顿

### 6. 测试NPC交互

1. 点击左侧的铁匠NPC
2. **应该看到：**
   - 控制台输出"铁匠NPC被点击"
   - 如果对话系统已实现，应该显示对话框
   - NPC有悬停效果（放大1.05倍）

### 7. 测试关闭铁匠铺

1. 点击右上角的关闭按钮（✕）
2. **应该看到：**
   - 铁匠铺界面关闭
   - 返回游戏主界面
   - 游戏恢复正常运行

### 8. 测试响应式布局

#### 桌面端（> 1024px）
- 面板宽度应为60%，最大800px
- 所有元素正常显示
- 动画流畅

#### 平板端（768px - 1024px）
- 面板宽度自适应
- 功能按钮可能需要调整
- 布局保持合理

#### 移动端（< 768px）
- 需要检查是否需要特殊布局
- 功能按钮可能需要改为横向排列
- 面板可能需要全屏显示

## 常见问题排查

### 问题1：面板不显示
**可能原因：**
- 动态面板容器未正确创建
- JavaScript错误阻止了面板创建

**检查方法：**
```javascript
// 在控制台执行
console.log(document.getElementById('forge-dynamic-panel'));
// 应该返回一个DOM元素，不是null
```

### 问题2：动画不流畅
**可能原因：**
- CSS transition未正确应用
- 浏览器性能问题

**检查方法：**
- 打开浏览器开发者工具
- 查看Performance标签
- 检查是否有大量重排/重绘

### 问题3：NPC不显示
**可能原因：**
- NPC精灵图未加载
- Canvas渲染失败

**检查方法：**
```javascript
// 在控制台执行
console.log(document.getElementById('npc-sprite-canvas'));
// 检查canvas元素是否存在
```

### 问题4：功能按钮点击无反应
**可能原因：**
- 事件监听器未正确绑定
- dynamicPanelManager未初始化

**检查方法：**
```javascript
// 在控制台执行
console.log(game.forgeUI.dynamicPanelManager);
// 应该返回DynamicPanelManager实例
```

### 问题5：背景图片不显示
**可能原因：**
- 图片URL无法访问
- CSS未正确加载

**检查方法：**
- 打开浏览器开发者工具
- 查看Network标签
- 检查图片是否成功加载

## 控制台测试命令

### 打开特定功能面板
```javascript
// 打开强化面板
game.forgeUI.showFunctionPanel('enhance');

// 打开宝石镶嵌面板
game.forgeUI.showFunctionPanel('socket');

// 打开宝石合成面板
game.forgeUI.showFunctionPanel('synthesis');

// 打开装备拆解面板
game.forgeUI.showFunctionPanel('dismantle');

// 打开批量操作面板
game.forgeUI.showFunctionPanel('batch');

// 打开操作历史面板
game.forgeUI.showFunctionPanel('history');
```

### 关闭当前面板
```javascript
game.forgeUI.dynamicPanelManager.closePanel();
```

### 更新NPC信息
```javascript
// 更新等级、好感度和称号
game.forgeUI.initialView.updateNPCInfo(10, 75, '亲密');
```

### 检查当前状态
```javascript
// 检查是否有面板打开
console.log(game.forgeUI.dynamicPanelManager.isPanelOpen());

// 获取当前打开的面板ID
console.log(game.forgeUI.dynamicPanelManager.getCurrentPanel());
```

## 性能测试

### 测试动画性能
1. 打开浏览器开发者工具
2. 切换到Performance标签
3. 点击Record按钮
4. 快速切换多个功能面板
5. 停止录制
6. 检查FPS是否保持在60左右

### 测试内存使用
1. 打开浏览器开发者工具
2. 切换到Memory标签
3. 拍摄堆快照
4. 打开/关闭铁匠铺多次
5. 再次拍摄堆快照
6. 对比内存使用，检查是否有内存泄漏

## 视觉回归测试

### 截图对比
1. 在不同浏览器中打开铁匠铺
2. 截图保存
3. 对比以下场景：
   - 初始状态
   - 各个功能面板打开状态
   - 动画过程中的中间状态

### 浏览器兼容性
测试以下浏览器：
- ✅ Chrome (最新版)
- ✅ Firefox (最新版)
- ✅ Safari (最新版)
- ✅ Edge (最新版)

## 测试清单

### 功能测试
- [ ] 铁匠铺可以正常打开
- [ ] 初始界面显示正确
- [ ] 所有功能按钮可以点击
- [ ] 面板可以正常显示
- [ ] 面板可以正常关闭
- [ ] 面板切换流畅
- [ ] NPC可以点击
- [ ] 关闭按钮工作正常

### 视觉测试
- [ ] 背景图片铺满屏幕
- [ ] NPC在左侧正确显示
- [ ] 功能按钮在右上角正确排列
- [ ] 面板在中央偏右位置
- [ ] 面板背景半透明
- [ ] 所有文字清晰可读
- [ ] 颜色和样式符合设计

### 动画测试
- [ ] 面板滑入动画流畅
- [ ] 面板滑出动画流畅
- [ ] 按钮悬停效果正常
- [ ] NPC悬停效果正常
- [ ] 动画时长合适（300ms/240ms）

### 响应式测试
- [ ] 桌面端布局正常
- [ ] 平板端布局正常
- [ ] 移动端布局正常
- [ ] 滚动条工作正常

### 性能测试
- [ ] FPS保持在60左右
- [ ] 无明显卡顿
- [ ] 无内存泄漏
- [ ] 资源加载正常

## 报告问题

如果发现问题，请记录以下信息：
1. 问题描述
2. 复现步骤
3. 预期行为
4. 实际行为
5. 浏览器和版本
6. 控制台错误信息
7. 截图或录屏

## 测试完成

测试完成后，请确认：
- ✅ 所有功能正常工作
- ✅ 视觉效果符合设计
- ✅ 动画流畅无卡顿
- ✅ 无明显bug或问题
- ✅ 性能表现良好

祝测试顺利！🎉
