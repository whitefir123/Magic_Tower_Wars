# 启用 mod_headers 模块
<IfModule mod_headers.c>
  # 添加 X-Content-Type-Options 响应头（防止 MIME 类型嗅探）
  Header set X-Content-Type-Options "nosniff"
  
  # 使用 Cache-Control 替代 Expires（更现代的缓存控制）
  Header set Cache-Control "public, max-age=3600"
  
  # 使用 Content-Security-Policy 替代 X-Frame-Options（更安全）
  Header set Content-Security-Policy "frame-ancestors 'none'"
  
  # 移除不必要的 X-XSS-Protection 响应头（现代浏览器已内置保护）
  Header unset X-XSS-Protection
  
  # 移除 Expires 响应头（使用 Cache-Control 代替）
  Header unset Expires
</IfModule>

# 启用 mod_rewrite 模块
<IfModule mod_rewrite.c>
  RewriteEngine On
  
  # 为静态资源添加缓存破坏支持
  # 例如: style.css?v=1.0 -> style.css
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^(.+)\?v=[\d.]+$ $1 [L]
</IfModule>

# 为不同文件类型设置合适的缓存策略
<FilesMatch "\.(js|css|png|jpg|jpeg|gif|svg|woff|woff2|ttf|eot)$">
  <IfModule mod_headers.c>
    Header set Cache-Control "public, max-age=31536000, immutable"
  </IfModule>
</FilesMatch>

# HTML 文件不缓存或短期缓存
<FilesMatch "\.html?$">
  <IfModule mod_headers.c>
    Header set Cache-Control "public, max-age=3600, must-revalidate"
  </IfModule>
</FilesMatch>

