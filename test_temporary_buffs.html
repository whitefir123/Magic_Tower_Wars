<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä¸´æ—¶Buffç³»ç»Ÿæµ‹è¯•</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 1200px;
      margin: 20px auto;
      padding: 20px;
      background: #1a1a2e;
      color: #fff;
    }
    .test-section {
      background: #16213e;
      padding: 20px;
      margin: 20px 0;
      border-radius: 8px;
      border: 2px solid #0f3460;
    }
    h2 {
      color: #ffd700;
      border-bottom: 2px solid #ffd700;
      padding-bottom: 10px;
    }
    .buff-card {
      background: #0f3460;
      padding: 15px;
      margin: 10px 0;
      border-radius: 6px;
      border-left: 4px solid;
    }
    .buff-card.temporary {
      border-left-color: #ff6b6b;
    }
    .buff-card.permanent {
      border-left-color: #4dabf7;
    }
    .quality-COMMON { color: #a0a0a0; }
    .quality-UNCOMMON { color: #5eff00; }
    .quality-RARE { color: #0070dd; }
    .quality-EPIC { color: #a335ee; }
    .quality-LEGENDARY { color: #ff8000; }
    .stat-display {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin: 20px 0;
    }
    .stat-item {
      background: #0f3460;
      padding: 10px;
      border-radius: 4px;
      text-align: center;
    }
    .stat-label {
      color: #888;
      font-size: 12px;
    }
    .stat-value {
      font-size: 24px;
      font-weight: bold;
      color: #ffd700;
    }
    button {
      background: #ffd700;
      color: #1a1a2e;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      margin: 5px;
    }
    button:hover {
      background: #ffed4e;
    }
    .log {
      background: #000;
      padding: 10px;
      border-radius: 4px;
      max-height: 200px;
      overflow-y: auto;
      font-family: monospace;
      font-size: 12px;
    }
    .log-entry {
      margin: 2px 0;
      padding: 2px 5px;
    }
    .log-entry.info { color: #4dabf7; }
    .log-entry.upgrade { color: #5eff00; }
    .log-entry.warning { color: #ff6b6b; }
  </style>
</head>
<body>
  <h1>ğŸ² ä¸´æ—¶Buffç³»ç»Ÿæµ‹è¯•</h1>
  
  <div class="test-section">
    <h2>ç©å®¶çŠ¶æ€</h2>
    <div class="stat-display">
      <div class="stat-item">
        <div class="stat-label">ç‰©ç†æ”»å‡»</div>
        <div class="stat-value" id="stat-p-atk">10</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">ç‰©ç†é˜²å¾¡</div>
        <div class="stat-value" id="stat-p-def">5</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">é­”æ³•æ”»å‡»</div>
        <div class="stat-value" id="stat-m-atk">8</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">é­”æ³•é˜²å¾¡</div>
        <div class="stat-value" id="stat-m-def">5</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">æœ€å¤§ç”Ÿå‘½</div>
        <div class="stat-value" id="stat-maxHp">100</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">å½“å‰æ¥¼å±‚</div>
        <div class="stat-value" id="stat-floor">1</div>
      </div>
    </div>
    
    <div>
      <button onclick="nextFloor()">è¿›å…¥ä¸‹ä¸€å±‚</button>
      <button onclick="resetStats()">é‡ç½®çŠ¶æ€</button>
    </div>
  </div>

  <div class="test-section">
    <h2>ä¸´æ—¶Buffæµ‹è¯•</h2>
    <p>ä¸´æ—¶buffåœ¨å½“å‰å±‚æœ‰æ•ˆï¼Œè¿›å…¥ä¸‹ä¸€å±‚åä¼šè‡ªåŠ¨æ¶ˆå¤±</p>
    
    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
      <button onclick="applyBuff('str', 'COMMON')">æ™®é€š åŠ›é‡Buff (+4)</button>
      <button onclick="applyBuff('str', 'UNCOMMON')">ä¼˜ç§€ åŠ›é‡Buff (+5)</button>
      <button onclick="applyBuff('str', 'RARE')">ç¨€æœ‰ åŠ›é‡Buff (+6)</button>
      <button onclick="applyBuff('str', 'EPIC')">å²è¯— åŠ›é‡Buff (+8)</button>
      <button onclick="applyBuff('str', 'LEGENDARY')">ä¼ è¯´ åŠ›é‡Buff (+10)</button>
      
      <button onclick="applyBuff('iron', 'RARE')">ç¨€æœ‰ é“çš®Buff (+6)</button>
      <button onclick="applyBuff('arc', 'EPIC')">å²è¯— å¥¥æœ¯Buff (+8)</button>
      <button onclick="applyBuff('ward', 'LEGENDARY')">ä¼ è¯´ å®ˆæŠ¤Buff (+10)</button>
      
      <button onclick="applyBuff('vit', 'COMMON')">æ™®é€š ç”Ÿå‘½Buff (+20)</button>
      <button onclick="applyBuff('vit', 'RARE')">ç¨€æœ‰ ç”Ÿå‘½Buff (+40)</button>
      <button onclick="applyBuff('vit', 'LEGENDARY')">ä¼ è¯´ ç”Ÿå‘½Buff (+80)</button>
    </div>
  </div>

  <div class="test-section">
    <h2>æ°¸ä¹…Buffæµ‹è¯•</h2>
    <p>æ€’æ°”å’Œé‡‘å¸buffç«‹å³ç”Ÿæ•ˆï¼Œä¸å—æ¥¼å±‚å½±å“</p>
    
    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
      <button onclick="applyBuff('fury', 'COMMON')">æ™®é€š æ€’æ°”Buff (+20)</button>
      <button onclick="applyBuff('fury', 'LEGENDARY')">ä¼ è¯´ æ€’æ°”Buff (+50)</button>
      <button onclick="applyBuff('fortune', 'COMMON')">æ™®é€š è´¢å¯ŒBuff (+100)</button>
      <button onclick="applyBuff('fortune', 'LEGENDARY')">ä¼ è¯´ è´¢å¯ŒBuff (+300)</button>
    </div>
  </div>

  <div class="test-section">
    <h2>å½“å‰æ¿€æ´»çš„ä¸´æ—¶Buff</h2>
    <div id="active-buffs">
      <p style="color: #888;">æš‚æ— æ¿€æ´»çš„ä¸´æ—¶buff</p>
    </div>
  </div>

  <div class="test-section">
    <h2>æ“ä½œæ—¥å¿—</h2>
    <div class="log" id="log"></div>
  </div>

  <script>
    // æ¨¡æ‹Ÿç©å®¶æ•°æ®
    const player = {
      stats: {
        p_atk: 10,
        p_def: 5,
        m_atk: 8,
        m_def: 5,
        maxHp: 100,
        hp: 100,
        floor: 1,
        rage: 0,
        gold: 0
      },
      temporaryBuffs: []
    };

    // Buffå®šä¹‰
    const BUFF_POOL = {
      str: { id: 'str', name: 'Might', stat: 'p_atk', label: 'ç‰©ç†æ”»å‡»' },
      iron: { id: 'iron', name: 'Iron Skin', stat: 'p_def', label: 'ç‰©ç†é˜²å¾¡' },
      arc: { id: 'arc', name: 'Arcana', stat: 'm_atk', label: 'é­”æ³•æ”»å‡»' },
      ward: { id: 'ward', name: 'Ward', stat: 'm_def', label: 'é­”æ³•é˜²å¾¡' },
      vit: { id: 'vit', name: 'Vitality', stat: 'maxHp', label: 'æœ€å¤§ç”Ÿå‘½' },
      fury: { id: 'fury', name: 'Fury', stat: 'rage', label: 'æ€’æ°”' },
      fortune: { id: 'fortune', name: 'Fortune', stat: 'gold', label: 'é‡‘å¸' }
    };

    // å“è´¨å¯¹åº”çš„æ•°å€¼
    const BUFF_VALUES = {
      str: { COMMON: 4, UNCOMMON: 5, RARE: 6, EPIC: 8, LEGENDARY: 10 },
      iron: { COMMON: 4, UNCOMMON: 5, RARE: 6, EPIC: 8, LEGENDARY: 10 },
      arc: { COMMON: 4, UNCOMMON: 5, RARE: 6, EPIC: 8, LEGENDARY: 10 },
      ward: { COMMON: 4, UNCOMMON: 5, RARE: 6, EPIC: 8, LEGENDARY: 10 },
      vit: { COMMON: 20, UNCOMMON: 30, RARE: 40, EPIC: 60, LEGENDARY: 80 },
      fury: { COMMON: 20, UNCOMMON: 25, RARE: 30, EPIC: 40, LEGENDARY: 50 },
      fortune: { COMMON: 100, UNCOMMON: 150, RARE: 200, EPIC: 250, LEGENDARY: 300 }
    };

    function log(message, type = 'info') {
      const logDiv = document.getElementById('log');
      const entry = document.createElement('div');
      entry.className = `log-entry ${type}`;
      entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      logDiv.appendChild(entry);
      logDiv.scrollTop = logDiv.scrollHeight;
    }

    function updateDisplay() {
      document.getElementById('stat-p-atk').textContent = player.stats.p_atk;
      document.getElementById('stat-p-def').textContent = player.stats.p_def;
      document.getElementById('stat-m-atk').textContent = player.stats.m_atk;
      document.getElementById('stat-m-def').textContent = player.stats.m_def;
      document.getElementById('stat-maxHp').textContent = player.stats.maxHp;
      document.getElementById('stat-floor').textContent = player.stats.floor;

      // æ›´æ–°ä¸´æ—¶buffæ˜¾ç¤º
      const activeBuffsDiv = document.getElementById('active-buffs');
      if (player.temporaryBuffs.length === 0) {
        activeBuffsDiv.innerHTML = '<p style="color: #888;">æš‚æ— æ¿€æ´»çš„ä¸´æ—¶buff</p>';
      } else {
        activeBuffsDiv.innerHTML = player.temporaryBuffs.map(buff => {
          const buffDef = BUFF_POOL[buff.buffId];
          return `
            <div class="buff-card temporary">
              <strong>${buffDef.name}</strong> - ${buffDef.label} +${buff.value}
              <br><small style="color: #888;">åº”ç”¨äºç¬¬${buff.appliedFloor}å±‚</small>
            </div>
          `;
        }).join('');
      }
    }

    function applyBuff(buffId, quality) {
      const buff = BUFF_POOL[buffId];
      const value = BUFF_VALUES[buffId][quality];
      const isTemporary = ['str', 'iron', 'arc', 'ward', 'vit'].includes(buffId);

      // åº”ç”¨buffæ•ˆæœ
      player.stats[buff.stat] += value;

      // å¦‚æœæ˜¯ä¸´æ—¶buffï¼Œè®°å½•
      if (isTemporary) {
        player.temporaryBuffs.push({
          buffId: buffId,
          value: value,
          appliedFloor: player.stats.floor
        });
        log(`åº”ç”¨ä¸´æ—¶buff: ${buff.name} (${quality}) - ${buff.label} +${value}`, 'upgrade');
      } else {
        log(`åº”ç”¨æ°¸ä¹…buff: ${buff.name} (${quality}) - ${buff.label} +${value}`, 'upgrade');
      }

      updateDisplay();
    }

    function nextFloor() {
      const oldFloor = player.stats.floor;
      player.stats.floor++;

      // æ¸…é™¤ä¸´æ—¶buff
      if (player.temporaryBuffs.length > 0) {
        log(`è¿›å…¥ç¬¬${player.stats.floor}å±‚ï¼Œæ¸…é™¤ä¸´æ—¶buff...`, 'warning');
        
        for (const tempBuff of player.temporaryBuffs) {
          const buffDef = BUFF_POOL[tempBuff.buffId];
          player.stats[buffDef.stat] -= tempBuff.value;
          log(`ç§»é™¤ä¸´æ—¶buff: ${buffDef.name} - ${buffDef.label} -${tempBuff.value}`, 'info');
        }
        
        player.temporaryBuffs = [];
        log('æ‰€æœ‰ä¸´æ—¶buffå·²æ¸…é™¤', 'info');
      } else {
        log(`è¿›å…¥ç¬¬${player.stats.floor}å±‚`, 'info');
      }

      updateDisplay();
    }

    function resetStats() {
      player.stats = {
        p_atk: 10,
        p_def: 5,
        m_atk: 8,
        m_def: 5,
        maxHp: 100,
        hp: 100,
        floor: 1,
        rage: 0,
        gold: 0
      };
      player.temporaryBuffs = [];
      log('çŠ¶æ€å·²é‡ç½®', 'info');
      updateDisplay();
    }

    // åˆå§‹åŒ–
    updateDisplay();
    log('ä¸´æ—¶Buffç³»ç»Ÿæµ‹è¯•å·²å¯åŠ¨', 'info');
  </script>
</body>
</html>
